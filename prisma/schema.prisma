// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id            String    @id @default(cuid())
  walletAddress String    @unique
  username      String?
  createdAt     DateTime  @default(now())
  contents      Content[]
}

model Content {
  id           String  @id @default(cuid())
  title        String
  description  String?
  thumbnailUrl String
  type         String // ENUM: ARTICLE, VIDEO, AUDIO
  price        Decimal @default(0)
  currency     String  @default("USDC")

  // Data Privat (Only accessible via API Gatekeeper)
  contentUrl  String? // For Video/Audio
  textContent String? @db.Text // For Article (renamed from body for PRD consistency)

  creatorId      String
  creatorAddress String // Redundant but needed for x402 header quick access
  creator        User   @relation(fields: [creatorId], references: [id])

  createdAt DateTime @default(now())

  @@index([creatorId])
  @@index([type])
}
